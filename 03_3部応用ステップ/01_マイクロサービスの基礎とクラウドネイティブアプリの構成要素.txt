第1章：マイクロサービスの基礎とクラウドネイティブアプリケーションの構成要素

■この章の読み方について

この章では、マイクロサービスやアプリケーション構成について
「これが正解である」という形では整理しません。

クラウドネイティブなアプリケーション設計においては、
・置かれている前提
・組織やチームの構造
・求められる変更頻度や安定性
によって、適切な判断が大きく変わるためです。

この章の目的は、特定の構成や技術を選ばせることではなく、

・なぜ分割という発想が生まれるのか
・どのような前提のもとで、その選択肢が成立するのか
・分割した瞬間に、どのような判断が新たに発生するのか

を整理し、自分たちの状況に照らして考え始められる状態になることです。
そのため、この章ではあえて結論を閉じずに話を進めていきます。


1. なぜ「マイクロサービス」という言葉は混乱を生むのか
マイクロサービスという言葉は、クラウドネイティブを語る文脈で頻繁に登場します。
一方で、この言葉が使われる場面を見ていると、

・技術構成の話をしている人
・組織やチーム分割の話をしている人
・スケール戦略の話をしている人

これらの人が同じ言葉を使いながら、まったく違うものを指している 
ことが少なくありません。

この状態で「マイクロサービスとは何か」という定義から入ってしまうと、
議論はかえって分かりにくくなります。

そこでこの章では、マイクロサービスを最初から完成された形として扱うことを避け、
アプリケーションをどう捉えるか、という一段手前の視点から話を始めます。


2. アプリケーションを「構成要素」として捉え直す
多くのアプリケーションは、次のような要素の組み合わせとして語られます。

・利用者とやり取りするUI
・処理や判断を担うAPI
・状態を保持するデータ

この分け方は、機能というより責務の観点で整理されている点に特徴があります。

重要なのは、この分け方自体が正解なのではなく、アプリケーションはいくつかの
異なる責務の集合として捉えられるという見方です。

単一のプロセスの中にすべてを詰め込んでいた場合、これらの責務は意識されにくくなります。
しかし、変更頻度や影響範囲を考え始めた瞬間、「どこまでを一緒に扱うか」という問いが現れます。

ここから、分割という発想が生まれます。


3. 分割すると、何が楽になり、何が難しくなるのか
アプリケーションを分割すると、一部の変更が他に影響しにくくなったり、
独立して扱える範囲が増えたりします。

一方で、分割によって新たに発生するものもあります。
・増える通信
・増える管理対象
・増える失敗の起点

分割は、複雑さを「減らす」行為ではありません。
多くの場合、複雑さの置き場所を変える行為です。

この複雑さをどこで引き受けるのかを考えずに分割だけを進めてしまうと、
設計はかえって扱いづらくなります。


4. マイクロサービスは「設計上の選択肢」である
ここまで見てきたように、分割という発想は、いくつかの設計上の要求から
自然に現れます。

・変更の影響範囲を抑えたい
・独立して更新したい
・責務を明確に分けたい

マイクロサービスという言葉は、これらの要求に対する
一つの選択肢に名前が付いたものにすぎません。

そのため、マイクロサービスの採用 / 不採用という判断は
どちらが正しいかではなく、どの前提を置いているかの違いです。

重要なのは、分割すること自体ではなく、分割した結果としてどの複雑さを引き受けるのか
を理解したうえで判断することです。


5. Kubernetesリソースとの対応関係をどう見るか
マイクロサービスの話を進めていくと、Pod、Service、Ingress といった
Kubernetes のリソースが登場します。

これらは、分割されたアプリケーションを
運用上成立させるための仕組みです。

注意したいのは、Kubernetes のリソース構成から
アプリケーションの分け方を決めてしまうことです。

本来は、どの責務を独立させたいのか
どこで変更の影響を止めたいのかという設計判断が先にあり、
Kubernetes のリソースはそれを支える立場にあります。

Kubernetes の存在によって、分割という選択肢が現実的になったのは事実ですが、
それは選択肢が増えたという意味に過ぎません。


6. この章のまとめ ― 分けた瞬間に、次の判断が始まる
この章では、マイクロサービスを「目指すべき形」としてではなく、
設計上の選択肢 として捉え直してきました。

アプリケーションを分割するかどうかは、設計判断の一つにすぎません。
そして、分割という判断を下した瞬間、次に必ず立ち現れる問いがあります。

分けたアプリケーションを、どのように安全に継続的に届け続けるのか・・・

次の章では、この問いを継続的デリバリーとGitOpsという観点から
整理していきます。